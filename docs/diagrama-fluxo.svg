<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="428px" preserveAspectRatio="none" style="width:697px;height:428px;background:#FFFFFF;" version="1.1" viewBox="0 0 697 428" width="697px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="30" x2="30" y1="81.2969" y2="347.3594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="143" x2="143" y1="81.2969" y2="347.3594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="294.5" x2="294.5" y1="81.2969" y2="347.3594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="450.5" x2="450.5" y1="81.2969" y2="347.3594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="579.5" x2="579.5" y1="81.2969" y2="347.3594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="652.5" x2="652.5" y1="81.2969" y2="347.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="5" y="77.9951">ESP32</text><ellipse cx="30.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M30.5,21.5 L30.5,48.5 M17.5,29.5 L43.5,29.5 M30.5,48.5 L17.5,63.5 M30.5,48.5 L43.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="5" y="359.3545">ESP32</text><ellipse cx="30.5" cy="371.1563" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M30.5,379.1563 L30.5,406.1563 M17.5,387.1563 L43.5,387.1563 M30.5,406.1563 L17.5,421.1563 M30.5,406.1563 L43.5,421.1563 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="91" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="98" y="69.9951">MQTT Broker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="91" y="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="98" y="366.3545">MQTT Broker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="160" x="214.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="221.5" y="69.9951">MQTT Client (Python)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="160" x="214.5" y="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="221.5" y="366.3545">MQTT Client (Python)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="388.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="395.5" y="69.9951">Backend (Flask)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="388.5" y="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="395.5" y="366.3545">Backend (Flask)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="554.5" y="77.9951">SQLite</text><path d="M561.5,29 C561.5,19 579.5,19 579.5,19 C579.5,19 597.5,19 597.5,29 L597.5,55 C597.5,65 579.5,65 579.5,65 C579.5,65 561.5,65 561.5,55 L561.5,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M561.5,29 C561.5,39 579.5,39 579.5,39 C579.5,39 597.5,39 597.5,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="554.5" y="359.3545">SQLite</text><path d="M561.5,372.6563 C561.5,362.6563 579.5,362.6563 579.5,362.6563 C579.5,362.6563 597.5,362.6563 597.5,372.6563 L597.5,398.6563 C597.5,408.6563 579.5,408.6563 579.5,408.6563 C579.5,408.6563 561.5,408.6563 561.5,398.6563 L561.5,372.6563 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M561.5,372.6563 C561.5,382.6563 579.5,382.6563 579.5,382.6563 C579.5,382.6563 597.5,382.6563 597.5,372.6563 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="614.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="621.5" y="69.9951">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="614.5" y="346.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="621.5" y="366.3545">Frontend</text><polygon fill="#181818" points="131.5,108.4297,141.5,112.4297,131.5,116.4297,135.5,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="137.5" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="37.5" y="107.3638">publish leitura</text><polygon fill="#181818" points="282.5,137.5625,292.5,141.5625,282.5,145.5625,286.5,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="143.5" x2="288.5" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="150.5" y="136.4966">entrega mensagem</text><line style="stroke:#181818;stroke-width:1.0;" x1="294.5" x2="336.5" y1="170.6953" y2="170.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="336.5" x2="336.5" y1="170.6953" y2="183.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="295.5" x2="336.5" y1="183.6953" y2="183.6953"/><polygon fill="#181818" points="305.5,179.6953,295.5,183.6953,305.5,187.6953,301.5,183.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="301.5" y="165.6294">valida/processa dados</text><polygon fill="#181818" points="567.5,208.8281,577.5,212.8281,567.5,216.8281,571.5,212.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="294.5" x2="573.5" y1="212.8281" y2="212.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="301.5" y="207.7622">salva (DAO)</text><polygon fill="#181818" points="461.5,237.9609,451.5,241.9609,461.5,245.9609,457.5,241.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="455.5" x2="652" y1="241.9609" y2="241.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="467.5" y="236.895">GET /leituras</text><polygon fill="#181818" points="567.5,267.0938,577.5,271.0938,567.5,275.0938,571.5,271.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450.5" x2="573.5" y1="271.0938" y2="271.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="457.5" y="266.0278">consulta leituras</text><polygon fill="#181818" points="461.5,296.2266,451.5,300.2266,461.5,304.2266,457.5,300.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="455.5" x2="578.5" y1="300.2266" y2="300.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="467.5" y="295.1606">retorna dados</text><polygon fill="#181818" points="641,325.3594,651,329.3594,641,333.3594,645,329.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="450.5" x2="647" y1="329.3594" y2="329.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="457.5" y="324.2935">JSON</text><!--MD5=[87a4efdfdf544cc38a1c20db89363439]
@startuml
actor ESP32

participant "MQTT Broker" as B
participant "MQTT Client (Python)" as C
participant "Backend (Flask)" as API
database "SQLite" as DB
participant "Frontend" as FE

ESP32 -> B : publish leitura
B -> C : entrega mensagem

C -> C : valida/processa dados
C -> DB : salva (DAO)

FE -> API : GET /leituras
API -> DB : consulta leituras
DB - -> API : retorna dados
API - -> FE : JSON
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>